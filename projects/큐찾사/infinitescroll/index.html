<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸° | ì±„ìˆ˜í˜„ ê°œë°œì¼ì§€</title><meta name=keywords content="Next.js,React Query,Infinite Scroll"><meta name=description content="React Queryì˜ InfiniteScrollì„ ì ìš©í•˜ëŠ” ë°©ë²•ê³¼ ìƒì„¸í˜ì´ì§€ì— ë“¤ì–´ê°”ë‹¤ ë‚˜ì˜¬ë•Œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì†Œê°œí•©ë‹ˆë‹¤."><meta name=author content="cha2hyun"><link rel=canonical href=https://cha2hyun.github.io/projects/%ED%81%90%EC%B0%BE%EC%82%AC/infinitescroll/><link crossorigin=anonymous href=/assets/css/stylesheet.e2c4e45c227cff2d0b236143ff7f2e39b6a7f2bd2019a845c0f754cd1b58fa1f.css integrity="sha256-4sTkXCJ8/y0LI2FD/38uOban8r0gGahFwPdUzRtY+h8=" rel="preload stylesheet" as=style><link rel=icon href=https://cha2hyun.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cha2hyun.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cha2hyun.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cha2hyun.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cha2hyun.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸°"><meta property="og:description" content="React Queryì˜ InfiniteScrollì„ ì ìš©í•˜ëŠ” ë°©ë²•ê³¼ ìƒì„¸í˜ì´ì§€ì— ë“¤ì–´ê°”ë‹¤ ë‚˜ì˜¬ë•Œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì†Œê°œí•©ë‹ˆë‹¤."><meta property="og:type" content="article"><meta property="og:url" content="https://cha2hyun.github.io/projects/%ED%81%90%EC%B0%BE%EC%82%AC/infinitescroll/"><meta property="og:image" content="https://cha2hyun.github.io/papermod-cover.png"><meta property="article:section" content="projects"><meta property="article:published_time" content="2022-11-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-11-04T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cha2hyun.github.io/papermod-cover.png"><meta name=twitter:title content="Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸°"><meta name=twitter:description content="React Queryì˜ InfiniteScrollì„ ì ìš©í•˜ëŠ” ë°©ë²•ê³¼ ìƒì„¸í˜ì´ì§€ì— ë“¤ì–´ê°”ë‹¤ ë‚˜ì˜¬ë•Œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì†Œê°œí•©ë‹ˆë‹¤."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"https://cha2hyun.github.io/projects/"},{"@type":"ListItem","position":3,"name":"Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸°","item":"https://cha2hyun.github.io/projects/%ED%81%90%EC%B0%BE%EC%82%AC/infinitescroll/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸°","name":"Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸°","description":"React Queryì˜ InfiniteScrollì„ ì ìš©í•˜ëŠ” ë°©ë²•ê³¼ ìƒì„¸í˜ì´ì§€ì— ë“¤ì–´ê°”ë‹¤ ë‚˜ì˜¬ë•Œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì†Œê°œí•©ë‹ˆë‹¤.","keywords":["Next.js","React Query","Infinite Scroll"],"articleBody":"\në“¤ì–´ê°€ë©° ìƒˆë¡œìš´ í™ˆí˜ì´ì§€ë¥¼ ê¸°íš, ê°œë°œí•˜ë©´ì„œ ìµœëŒ€í•œ ì•±ê³¼ ë™ì¼í•œ ì‚¬ìš©ì ê²½í—˜ì„ ì£¼ê¸° ìœ„í•´ ê³ ë¯¼ì„ ë§ì´ í–ˆìŠµë‹ˆë‹¤. ì˜¤ë«ë™ì•ˆ ì¤€ë¹„í–ˆë˜ apppage_v2ì˜ ê²½ìš° reactë¡œ ì œì‘í•˜ì˜€ìœ¼ë©° ì¼ë°˜ì ì¸ í˜ì§€ë„¤ì´ì…˜ì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ì¼ë°˜ì ì¸ í˜ì§€ë„¤ì´ì…˜ìœ¼ë¡œëŠ” ëª¨ë°”ì¼ì—ì„œ ì•±ê³¼ ê°™ì€ ê²½í—˜ì„ ì£¼ì§€ ëª»í•˜ëŠ” ì ì´ ì•„ì‰¬ì›Œ ì•„ì˜ˆ ìƒˆë¡­ê²Œ Next.jsë¡œ í”„ë¡œì íŠ¸ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ React Queryì˜ infiniteScrollì„ ë„ì…í•˜ì˜€ìŠµë‹ˆë‹¤. infiniteScrollì„ ë„ì…í•˜ë©´ì„œ ë°°ìš´ ë‚´ìš©ë“¤ì„ ë‹¤ë£¹ë‹ˆë‹¤. ì†ë„ê°€ ì¤‘ìš”í•œ ê²ƒì€ Modalë¡œ í‘œì‹œí•˜ê³  ìƒí˜¸ì‘ìš©ì´ ì¤‘ìš”í•œ ê²ƒì€ Linkë¡œ í˜ì´ì§€ ì´ë™í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ ìºì‹±ì„ ìœ„í•œ ë°©ë²•ê³¼ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ë‹ˆë‹¤. APIëŠ” ì¥ê³ ë¡œ ë§Œë“¤ì—ˆìœ¼ë©° í’€ìŠ¤íƒìœ¼ë¡œ ë‚´ìš©ì„ ë‹¤ë£¹ë‹ˆë‹¤.\nê³ ì¹˜ëŠ” ê²ƒ ë³´ë‹¤ ìƒˆë¡œ ë§Œë“œëŠ”ê²Œ ë” ë¹ ë¥¸â€¦\nCustom Modal vs Link ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ë„ì…í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì´ ê³ ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤.\në¬´í•œ ìŠ¤í¬ë¡¤ì´ ì ìš©ëœ ë¦¬ìŠ¤íŠ¸ë¥¼ í´ë¦­í–ˆì„ë•Œ ì–´ë–¤ ì‹ìœ¼ë¡œ ìƒì„¸í˜ì´ì§€ë¥¼ ì œê³µí•  ê²ƒì¸ê°€? ìƒì„¸í˜ì´ì§€ì—ì„œ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ê°ˆë•Œ ì´ë¯¸ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•„ì•¼í•œë‹¤. 2ë²ˆì´ ì ìš©ëœë‹¤ë©´ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ê°ˆë•Œ ìŠ¤í¬ë¡¤ í–ˆë˜ ìœ„ì¹˜ë¡œ ëŒì•„ê°€ì ¸ì•¼í•œë‹¤. ë¬´í•œ ìŠ¤í¬ë¡¤ì´ ë„ì…ë  ê³³ì€ ë‚´íì°¾ê¸°ì™€ ì»¤ë®¤ë‹ˆí‹° ì˜€ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ë‘ ì¹´í…Œê³ ë¦¬ëŠ” ê°ì ë‹¤ë¥¸ íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ í•µì‹¬ ëª¨ë¸ì´ ì ìš”ë˜ëŠ” ë‚´íì°¾ê¸°ì—ì„œëŠ” ìµœëŒ€í•œ ë¹ ë¥´ê²Œ ìœ ì €ì—ê²Œ ë¡œë”©ë˜ëŠ” ê²½í—˜ì„ ì£¼ì–´ì•¼í•˜ê³ , ì»¤ë®¤ë‹ˆí‹°ì—ì„œëŠ” ëŒ“ê¸€, ë‹µê¸€ ë“±ì˜ ì¶”ê°€ ê¸°ëŠ¥ë“¤ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.\nì†ë„ê°€ ì¤‘ìš”í•œ ë‚´íì°¾ê¸°ì—ëŠ” Modal ì„ ì´ìš©í•˜ì˜€ìœ¼ë©°, API ìƒí˜¸ì‘ìš© ë° ìƒˆë¡œê³ ì¹¨ì´ í•„ìš”í•œ ì»¤ë®¤ë‹ˆí‹°ì—ì„œëŠ” ìƒˆë¡œìš´ í˜ì´ì§€ë¡œ ì´ë™í•˜ê³  ë’¤ë¡œê°€ê¸° ì‹œì— LocalStorageë¥¼ ì°¸ì¡°í•˜ì—¬ ì €ì¥ëœ ScrollYê°’ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™ë˜ê²Œ í•˜ì˜€ìŠµë‹ˆë‹¤.\në‚´íì°¾ê¸° (ì ìš©ëœ í˜ì´ì§€)\ní˜ì´ì§€ ì´ë™ì—†ì´ Modalì´ ë³´ì—¬ì§€ëŠ” í˜•ì‹ìœ¼ë¡œ ì œê³µí•œë‹¤. Modalì´ ì—´ë¦´ë•Œ ë”°ë¡œ APIì—ì„œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šê³  ì¦‰ì‹œ ë³´ì—¬ì§ˆ ìˆ˜ ìˆë„ë¡ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¬ ë•Œ APIë¥¼ ëª¨ë‹¬ì•ˆì˜ ì •ë³´ê¹Œì§€ ì œê³µí•  ìˆ˜ ìˆë„ë¡ ì œì‘í•œë‹¤. í•œë²ˆ ë¶ˆëŸ¬ì˜¨ ì´ë¯¸ì§€ë‚˜ ìºì‹œì— ë‚¨ê²¨ ë¡œë”©í•  ë•Œë„ ë§¤ìš°ë¹ ë¥¸ ë¡œë”©ì†ë„ë¥¼ ì œê³µí•œë‹¤. ìŠ¤í¬ë¡¤ ì‹œ ë§ˆì§€ë§‰ ì•„ì´í…œì´ ë³´ì—¬ì§ˆ ë•Œ ë§ˆë‹¤ Fade in ì• ë‹ˆë©”ì´ì…˜ì„ ì ìš©í•˜ì—¬ ë¡œë”©ì´ ì¦‰ê°ì ìœ¼ë¡œ ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì—¬ì§€ê²Œ í•œë‹¤. Infinite Scroll + Modal + aos fadein\nì»¤ë®¤ë‹ˆí‹° (ì ìš©ëœ í˜ì´ì§€)\nListì—ì„œ Item í´ë¦­ ì‹œ ìƒˆë¡œìš´ ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™ ì´ë™í• ë•Œ ì´ë•Œ LocalStoargeì— scrollY ê°’ì„ ì €ì¥ ìƒì„¸í˜ì´ì§€ì—ì„œ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ì˜¬ ë•Œ scrollY ê°’ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ë™ ë‹¨, ì´ë•Œ ì²˜ìŒë¶€í„° Listë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´ ì €ì¥ëœ scrollY ê°’ìœ¼ë¡œ ê°€ì§ˆ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ (1ë²ˆ ì´ìƒ ì¶”ê°€ë¡œë”©ì´ ë˜ì—ˆì„ ê²½ìš°) ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ëŠ” ìƒˆë¡œ ë¶ˆëŸ¬ì˜¤ë©´ ì•ˆëœë‹¤. Infinite Scroll + Link + LocalStorage\nAPI ì¤€ë¹„ APIëŠ” Djangoë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ModelViewSetì„ ì‚¬ìš©í•˜ì˜€ìœ¼ë©° LimitOffsetPaginationì„ ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\nì¼ë°˜ì ì¸ í˜ì´ì§€ í˜ì§€ë„¤ì´ì…˜ì˜ ê²½ìš° ì‚¬ìš©ìê°€ ë‹¤ìŒ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸° ì „ì— ìƒˆë¡œìš´ ì•„ì´í…œì´ 1ê°œê°€ ë“±ë¡ë˜ê³  ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´ ì¤‘ë³µë˜ëŠ” ì•„ì´í…œì´ í‘œì‹œë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ offset paginationì„ ì ìš©í•˜ì—¬ ì „ì²´ ê²Œì‹œê¸€ì´ ëŠ˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ëŠ˜ì€ ë§Œí¼ offsetì„ ì¶”ê°€ë¡œ ë”í•´ì£¼ì–´ì•¼ ì¤‘ë³µë˜ëŠ” ì•„ì´í…œì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në¦¬ìŠ¤íŠ¸ì—ì„œ ë¡œë”©ë  í•„í„°ë§ ì¡°ê±´ì„ parameter ë¡œ ë°›ê¸° ìœ„í•´ querysetì„ ë³€ê²½í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ì˜€ìŠµë‹ˆë‹¤. offsetë˜í•œ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì˜µë‹ˆë‹¤.\nviews.py views.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 class someview(viewsets.ModelViewSet): queryset = somemodel.objects.exclude(Q(something)).prefetch_related(Prefetch(something)).all() permission_classes = somepermission serializer_class = someSerializer pagination_class = LimitOffsetPagination filter_backends = (somefilters) ordering_fields = ('created_at','id') ordering = ('-created_at') search_fields = ['$title', '$content'] filterset_fields = ('__all__') def get_queryset(self): qs = super().get_queryset() # some condition return qs.filter(Query) ë¦¬í„´ ì˜ˆì‹œ\nGET 1 2 3 4 5 6 7 8 { \"count\": 131, \"next\": \"apiì£¼ì†Œ/?limit=20\u0026offset=55\u0026í•„í„°ë§ì¡°ê±´\", \"previous\": \"apiì£¼ì†Œ/?limit=20\u0026offset=15\u0026í•„í„°ë§ì¡°ê±´\", \"results\":[ ... ] } infiniteScroll ì„¤ì¹˜ ë° ì¤€ë¹„ react-qeuryë¥¼ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤. ì‚¬ìš©ëœ ë²„ì „ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\npackage.json 1 2 3 ... \"react-query\": \"^3.39.2\", ... Hydrationì„ í†µí•´ SSR(Server Side Rendering)ì„ í•  ìˆ˜ ë„ ìˆì§€ë§Œ, ì‹œë„í•´ë³¸ ê²°ê³¼ ë§¤ ë’¤ë¡œê°€ê¸°ì‹œ ìºì‹±ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ì •í™•íˆ ë§í•˜ë©´ ì´ë¯¸ ë¡œë”©í–ˆë˜ ë‚´ìš©ë“¤ì„ ë‹¤ì‹œ ì²˜ìŒë¶€í„° ë¡œë”©í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. ë‚´íì°¾ê¸° ì²˜ëŸ¼ ëª¨ë‹¬ì„ ì‚¬ìš©í•  ê²½ìš° Hydration ì‚¬ìš©í•´ë„ ì§€ì¥ì—†ì§€ë§Œ, í˜ì´ì§€ ì´ë™ì´ í•„ìš”í•œ ê²½ìš° í•´ë‹¹ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.\n_app.tsx (Hydration) _app.tsx (Hydration) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 /* eslint-disable @typescript-eslint/no-explicit-any */ import AOS from \"aos\"; import Head from \"next/head\"; import { SessionProvider } from \"next-auth/react\"; import React, { useEffect } from \"react\"; import { QueryClient, QueryClientProvider } from \"react-query\"; import \"@/styles/aos.scss\"; import \"@/styles/globals.css\"; import \"@/styles/colors.css\"; const MyApp: NextComponentType\u003cAppContext, AppInitialProps, AppProps\u003e = ({ Component, pageProps, }) =\u003e { const queryClientRef = React.useRef\u003cQueryClient\u003e(); if (!queryClientRef.current) { queryClientRef.current = new QueryClient(); } useEffect(() =\u003e { AOS.init({ once: true, duration: 500, easing: \"ease-out-cubic\", }); }); return ( \u003c\u003e \u003cQueryClientProvider client={queryClientRef.current}\u003e \u003cHydrate state={pageProps.dehydratedState}\u003e \u003cComponent {...pageProps} /\u003e \u003c/Hydrate\u003e {/* */} \u003c/QueryClientProvider\u003e \u003c/\u003e ); }; MyApp.getInitialProps = async ({ Component, ctx, }: AppContext): Promise\u003cAppInitialProps\u003e =\u003e { let pageProps = {}; if (Component.getInitialProps) { pageProps = await Component.getInitialProps(ctx); } return { pageProps }; }; export default MyApp; ë”°ë¼ì„œ ìµœì¢…ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì ìš©í–ˆìŠµë‹ˆë‹¤. ì¤‘ê°„ì— meta íƒœê·¸ëŠ” ì•„ì´í°ì—ì„œ ëª¨ë‹¬ì´ ì—´ë¦´ë•Œ ê°€ë¡œí­ì´ ê³ ì •ë˜ì§€ ì•ŠëŠ” ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë„£ì—ˆìœ¼ë©° ë”°ë¡œ meta tagë¥¼ ê´€ë¦¬í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ìˆìœ¼ë©´ ì¶”ê°€í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ëŒ“ê¸€ ì‘ì„±ì´ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ë•Œë¬¸ì— SessionProvider (next-auth)ê°€ ìˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ êµ¬í˜„ì´ í•„ìš” ì—†ë‹¤ë©´ ë„˜ê¸°ì…”ë„ ë©ë‹ˆë‹¤.\n_app.tsx _app.tsx 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 /* eslint-disable @typescript-eslint/no-explicit-any */ import AOS from \"aos\"; import Head from \"next/head\"; import { SessionProvider } from \"next-auth/react\"; import React, { useEffect } from \"react\"; import { QueryClient, QueryClientProvider } from \"react-query\"; import \"@/styles/aos.scss\"; import \"@/styles/globals.css\"; import \"@/styles/colors.css\"; const MyApp = ({ Component, pageProps: { session, ...pageProps }, }: { Component: any; pageProps: any; }) =\u003e { const [queryClient] = React.useState(() =\u003e new QueryClient()); // AOS ì• ë‹ˆë©”ì´ì…˜ ì ìš© useEffect(() =\u003e { AOS.init({ once: true, duration: 500, easing: \"ease-out-cubic\", }); }); (\"\"); return ( // next-auth ë¡œê·¸ì¸ ì„¸ì…˜ì„ ìœ„í•´ ì‚¬ìš©ë¨ \u003cSessionProvider session={session}\u003e \u003cHead\u003e {/* ì•„ì´í° ê°€ë¡œê°’ ê³ ì •ë˜ì§€ ì•ŠëŠ” ì´ìŠˆ í•´ê²° */} \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover\" /\u003e \u003c/Head\u003e {/* infiniteScroll ìœ„í•´ ì„ ì–¸ */} \u003cQueryClientProvider client={queryClient}\u003e {/* PageProps í‘œì‹œ ì˜ì—­ */} \u003cComponent {...pageProps} /\u003e {/* Debug ëª¨ë“œì—ì„œë§Œ í™œìš©í•  devtools */} {/* import { ReactQueryDevtools } from 'react-query/devtools'; */} \u003c/QueryClientProvider\u003e \u003c/SessionProvider\u003e ); }; export default MyApp; ë¬´í•œ ë¡œë”© ë¦¬ìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•˜ëŠ” í° ë¼ˆëŒ€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë‹¹ì—°íˆ ì½”ë“œê°€ ëŒì•„ê°€ì§€ ì•Šìœ¼ë¯€ë¡œ ì°¸ê³ ë§Œ í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.\nInfiniteListSkeleton.tsx InfiniteListSkeleton.tsx 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 const InfiniteListSkeleton = ('í•„í„°ë§ ë  ë‚´ìš©ë“¤') =\u003e { const { data, hasNextPage, fetchNextPage, refetch, isFetching } = useInfiniteQuery( 'some', ({ pageParam = '' }) =\u003e // FetchList í•¨ìˆ˜ëŠ” axiosë¡œ apiì— request ë³´ë‚´ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. (íŒŒë¼ë¯¸í„°ë¡œ í•„í„°ë§ ë  ë‚´ìš©ì„ ë°›ìŠµë‹ˆë‹¤.) FetchList( pageParam, 'í•„í„°ë§ ë  ë‚´ìš©ë“¤' ), { // ë‹¤ìŒ í˜ì´ì§€ëŠ” offset ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤. getNextPageParam: (lastPage) =\u003e { if (lastPage.next === null) { return undefined; } const url = new URL(lastPage.next); const lastOffset = url.searchParams.get('offset'); if (lastOffset) { return parseInt(lastOffset); } else { return undefined; } }, staleTime: 60 * 1000, cacheTime: 60 * 1000, keepPreviousData: true, refetchOnMount: false, refetchOnWindowFocus: false, } ); // 1. ëª¨ë‹¬ë¡œ ì˜¤í”ˆí•  ê±°ë©´ (ì»¤ìŠ¤í…€ í›…) const dialog = useDialog(); const openModal = (props: Results) =\u003e { dialog({ title: '', description: \u003c\u003e\u003c/\u003e, catchOnCancel: true, submitText: 'ë„¤', cancleText: 'ë‹«ê¸°', variant: 'warning', props: props, }) .then() .catch(); return \u003c\u003e\u003c/\u003e; }; // 2. í˜ì´ì§€ ì´ë™í›„ ìŠ¤í¬ë¡¤ Y ê°’ì„ ì €ì¥í•˜ì—¬ í•´ë‹¹ ìœ„ì¹˜ë¡œ ë°”ë¡œ ë³´ì—¬ì§€ê²Œ í•  ê²½ìš° const [scrollY, setScrollY] = useLocalStorage('someScroll', 0); React.useEffect(() =\u003e { if (scrollY !== 0) { window.scrollTo(0, Number(scrollY)); setScrollY(0); } // eslint-disable-next-line react-hooks/exhaustive-deps }, []); // í•„í„°ê°€ ì ìš©ë˜ë©´ offsetì„ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒë¶€í„° ë¡œë”©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. React.useEffect(() =\u003e { if (isRefreshing) { refetch(); } setIsRefreshing(false); }, [isRefreshing, refetch, setIsRefreshing]); // useRefë¥¼ ì´ìš©í•˜ì—¬ í•´ë‹¹ Refë¥¼ í•˜ë‹¨ì— ë‘ê³  ë³´ì—¬ì§€ë©´ ë‹¤ìŒ í˜ì´ì§€ë¥¼ ë¡œë”©í•©ë‹ˆë‹¤. const loadMoreButtonRef = React.useRef(null); useIntersectionObserver({ root: null, target: loadMoreButtonRef, onIntersect: fetchNextPage, enabled: hasNextPage, }); return ( \u003c\u003e \u003cul\u003e {/* ë¡œë”©ì¤‘ì¼ë•Œ */} {isFetching \u0026\u0026 \u003cLoadingDiv /\u003e} {/* ë¦¬ìŠ¤íŠ¸ë¥¼ í‘œì‹œí•©ã„´ë””ã…. */} {data?.pages.map((page) =\u003e page.results.map((props: Results) =\u003e ( // data-aos ë¡œ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ì¤ë‹ˆë‹¤. (ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í•„ìš”)) \u003cli key={props.id} data-aos='fade-up' data-aos-duration='200'\u003e {/* 1. ëª¨ë‹¬ë¡œ ì˜¤í”ˆí• êº¼ë©´ */} \u003cdiv onClick={() =\u003e openModal(props)}\u003e Click ${props.id} to open Modal \u003c/div\u003e {/* 2. í˜ì´ì§€ ì´ë™í• ê±°ë©´ */} \u003cLink href={{ pathname: `url/${props.id}`, query: { props: JSON.stringify(props) }, }} as={`url/${props.id}`} passHref \u003e \u003ca href={`url/${props.id}`} onClick={() =\u003e setScrollY(window.scrollY)} \u003e \u003cdiv\u003eClick ${props.id} to navigate\u003c/div\u003e \u003c/a\u003e \u003c/Link\u003e \u003c/li\u003e )))} \u003c/ul\u003e {/* ë¡œë”©ì¤‘ í‘œì‹œë¥¼ í•˜ê³  refê°€ focus ë ë•Œ (ë¦¬ìŠ¤íŠ¸ì˜ ëì¼ë•Œ) ë§ˆë‹¤ ë‹¤ìŒ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¡œë”©í•©ë‹ˆë‹¤. */} {hasNextPage \u0026\u0026 ( \u003c\u003e \u003cLoadingDiv /\u003e \u003cbutton onClick={() =\u003e fetchNextPage()} className='text-center' /\u003e \u003c/\u003e )} \u003cdiv ref={loadMoreButtonRef} /\u003e \u003c/\u003e ); }; export default InfiniteListSkeleton; infiniteScroll + Modal [ë‚´íì°¾ê¸°] ê³„ì† â€¦\ninfiniteScroll + LocalStorage + ScrollY [ì»¤ë®¤ë‹ˆí‹°] ê³„ì† â€¦\n","wordCount":"1422","inLanguage":"en","datePublished":"2022-11-04T00:00:00Z","dateModified":"2022-11-04T00:00:00Z","author":{"@type":"Person","name":"cha2hyun"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cha2hyun.github.io/projects/%ED%81%90%EC%B0%BE%EC%82%AC/infinitescroll/"},"publisher":{"@type":"Organization","name":"ì±„ìˆ˜í˜„ ê°œë°œì¼ì§€","logo":{"@type":"ImageObject","url":"https://cha2hyun.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div><div class=logo><a href=https://cha2hyun.github.io/ accesskey=h title="ì±„ìˆ˜í˜„ ê°œë°œì¼ì§€ (Alt + H)">ì±„ìˆ˜í˜„ ê°œë°œì¼ì§€<span style=justify-content:center>
<img src="https://visitor-badge.glitch.me/badge?page_id=cha2hyun.github.io&left_color=black&right_color=black&left_text=HITS" alt=Views></span></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><div class=logo style=margin-bottom:-30px;margin-top:-30px;font-size:15px><span>ê¸°ì–µì€ ìœ í•œí•˜ë‚˜, ê¸°ë¡ì€ ë¬´í•œí•˜ë‹¤ ğŸ“š</span></div></div><ul id=menu><li><a href=https://cha2hyun.github.io/projects/ title=í”„ë¡œì íŠ¸><span style=font-weight:700>í”„ë¡œì íŠ¸</span></a></li><li><a href=https://cha2hyun.github.io/algorithm/ title=ì•Œê³ ë¦¬ì¦˜><span style=font-weight:700>ì•Œê³ ë¦¬ì¦˜</span></a></li><li><a href=https://cha2hyun.github.io/posts/ title=ë¸”ë¡œê·¸><span style=font-weight:700>ë¸”ë¡œê·¸</span></a></li><li><a href=https://cha2hyun.github.io/search/ title=ê²€ìƒ‰><span style=font-weight:700>ê²€ìƒ‰</span></a></li><li><a href=https://cha2hyun.github.io/tags/ title=íƒœê·¸><span style=font-weight:700>íƒœê·¸</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs></div><a href=https://cha2hyun.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://cha2hyun.github.io/projects/>Projects</a></div><h1 class=post-title>Next.js] InfiniteScroll ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œì„ Modalë¡œ ì—´ê±°ë‚˜ LocalStorageë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¡¤ëœ ìœ„ì¹˜ ê¸°ì–µí•˜ê¸°</h1><div class=post-meta><div class=views style=margin-right:8px><span class=views><img src="https://visitor-badge.glitch.me/badge?page_id=https%3a%2f%2fcha2hyun.github.io%2fprojects%2f%25ED%2581%2590%25EC%25B0%25BE%25EC%2582%25AC%2finfinitescroll%2f&left_color=gray&right_color=gray&left_text=Article Hits" alt=Views></span></div><span title='2022-11-04 00:00:00 +0000 UTC'>November 4, 2022</span>&nbsp;Â·&nbsp;7 min&nbsp;Â·&nbsp;cha2hyun</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%eb%93%a4%ec%96%b4%ea%b0%80%eb%a9%b0 aria-label=ë“¤ì–´ê°€ë©°>ë“¤ì–´ê°€ë©°</a></li><li><a href=#custom-modal-vs-link aria-label="Custom Modal vs Link"><code>Custom Modal</code> vs <code>Link</code></a></li><li><a href=#api-%ec%a4%80%eb%b9%84 aria-label="API ì¤€ë¹„">API ì¤€ë¹„</a><ul><li><a href=#viewspy aria-label=views.py><code>views.py</code></a></li></ul></li><li><a href=#infinitescroll-%ec%84%a4%ec%b9%98-%eb%b0%8f-%ec%a4%80%eb%b9%84 aria-label="infiniteScroll ì„¤ì¹˜ ë° ì¤€ë¹„"><code>infiniteScroll</code> ì„¤ì¹˜ ë° ì¤€ë¹„</a><ul><li><a href=#_apptsx-hydration aria-label="_app.tsx (Hydration)"><code>_app.tsx (Hydration)</code></a></li><li><a href=#_apptsx aria-label=_app.tsx><code>_app.tsx</code></a></li><li><a href=#infinitelistskeletontsx aria-label=InfiniteListSkeleton.tsx><code>InfiniteListSkeleton.tsx</code></a></li></ul></li><li><a href=#infinitescroll--modal-%eb%82%b4%ed%81%90%ec%b0%be%ea%b8%b0 aria-label="infiniteScroll + Modal [ë‚´íì°¾ê¸°]"><code>infiniteScroll</code> + <code>Modal</code> [ë‚´íì°¾ê¸°]</a></li><li><a href=#infinitescroll--localstorage--scrolly-%ec%bb%a4%eb%ae%a4%eb%8b%88%ed%8b%b0 aria-label="infiniteScroll + LocalStorage + ScrollY [ì»¤ë®¤ë‹ˆí‹°]"><code>infiniteScroll</code> + <code>LocalStorage</code> + <code>ScrollY</code> [ì»¤ë®¤ë‹ˆí‹°]</a></li></ul></div></details></div><div class=post-content><br><h3 id=ë“¤ì–´ê°€ë©°>ë“¤ì–´ê°€ë©°<a hidden class=anchor aria-hidden=true href=#ë“¤ì–´ê°€ë©°>#</a></h3><p>ìƒˆë¡œìš´ í™ˆí˜ì´ì§€ë¥¼ ê¸°íš, ê°œë°œí•˜ë©´ì„œ ìµœëŒ€í•œ <code>ì•±</code>ê³¼ ë™ì¼í•œ ì‚¬ìš©ì ê²½í—˜ì„ ì£¼ê¸° ìœ„í•´ ê³ ë¯¼ì„ ë§ì´ í–ˆìŠµë‹ˆë‹¤. ì˜¤ë«ë™ì•ˆ ì¤€ë¹„í–ˆë˜ <code>apppage_v2</code>ì˜ ê²½ìš° <code>react</code>ë¡œ ì œì‘í•˜ì˜€ìœ¼ë©° ì¼ë°˜ì ì¸ í˜ì§€ë„¤ì´ì…˜ì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ì¼ë°˜ì ì¸ í˜ì§€ë„¤ì´ì…˜ìœ¼ë¡œëŠ” ëª¨ë°”ì¼ì—ì„œ <code>ì•±</code>ê³¼ ê°™ì€ ê²½í—˜ì„ ì£¼ì§€ ëª»í•˜ëŠ” ì ì´ ì•„ì‰¬ì›Œ ì•„ì˜ˆ ìƒˆë¡­ê²Œ <code>Next.js</code>ë¡œ í”„ë¡œì íŠ¸ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ <code>React Query</code>ì˜ <code>infiniteScroll</code>ì„ ë„ì…í•˜ì˜€ìŠµë‹ˆë‹¤. <code>infiniteScroll</code>ì„ ë„ì…í•˜ë©´ì„œ ë°°ìš´ ë‚´ìš©ë“¤ì„ ë‹¤ë£¹ë‹ˆë‹¤. ì†ë„ê°€ ì¤‘ìš”í•œ ê²ƒì€ Modalë¡œ í‘œì‹œí•˜ê³  ìƒí˜¸ì‘ìš©ì´ ì¤‘ìš”í•œ ê²ƒì€ Linkë¡œ í˜ì´ì§€ ì´ë™í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ ìºì‹±ì„ ìœ„í•œ ë°©ë²•ê³¼ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ë‹ˆë‹¤. APIëŠ” ì¥ê³ ë¡œ ë§Œë“¤ì—ˆìœ¼ë©° í’€ìŠ¤íƒìœ¼ë¡œ ë‚´ìš©ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p><p><figure class=align-center><img loading=lazy src=../img/1.png#center alt="ê³ ì¹˜ëŠ” ê²ƒ ë³´ë‹¤ ìƒˆë¡œ ë§Œë“œëŠ”ê²Œ ë” ë¹ ë¥¸&amp;hellip;"><figcaption><p>ê³ ì¹˜ëŠ” ê²ƒ ë³´ë‹¤ ìƒˆë¡œ ë§Œë“œëŠ”ê²Œ ë” ë¹ ë¥¸&mldr;</p></figcaption></figure><br></p><h3 id=custom-modal-vs-link><code>Custom Modal</code> vs <code>Link</code><a hidden class=anchor aria-hidden=true href=#custom-modal-vs-link>#</a></h3><p>ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ë„ì…í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì´ ê³ ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤.</p><ol><li>ë¬´í•œ ìŠ¤í¬ë¡¤ì´ ì ìš©ëœ ë¦¬ìŠ¤íŠ¸ë¥¼ í´ë¦­í–ˆì„ë•Œ ì–´ë–¤ ì‹ìœ¼ë¡œ ìƒì„¸í˜ì´ì§€ë¥¼ ì œê³µí•  ê²ƒì¸ê°€?</li><li>ìƒì„¸í˜ì´ì§€ì—ì„œ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ê°ˆë•Œ ì´ë¯¸ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•„ì•¼í•œë‹¤.</li><li>2ë²ˆì´ ì ìš©ëœë‹¤ë©´ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ê°ˆë•Œ ìŠ¤í¬ë¡¤ í–ˆë˜ ìœ„ì¹˜ë¡œ ëŒì•„ê°€ì ¸ì•¼í•œë‹¤.</li></ol><p>ë¬´í•œ ìŠ¤í¬ë¡¤ì´ ë„ì…ë  ê³³ì€ <code>ë‚´íì°¾ê¸°</code>ì™€ <code>ì»¤ë®¤ë‹ˆí‹°</code> ì˜€ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ë‘ ì¹´í…Œê³ ë¦¬ëŠ” ê°ì ë‹¤ë¥¸ íŠ¹ì„±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì„œë¹„ìŠ¤ í•µì‹¬ ëª¨ë¸ì´ ì ìš”ë˜ëŠ” <code>ë‚´íì°¾ê¸°</code>ì—ì„œëŠ” ìµœëŒ€í•œ ë¹ ë¥´ê²Œ ìœ ì €ì—ê²Œ ë¡œë”©ë˜ëŠ” ê²½í—˜ì„ ì£¼ì–´ì•¼í•˜ê³ , <code>ì»¤ë®¤ë‹ˆí‹°</code>ì—ì„œëŠ” ëŒ“ê¸€, ë‹µê¸€ ë“±ì˜ ì¶”ê°€ ê¸°ëŠ¥ë“¤ì´ í•„ìš”í–ˆìŠµë‹ˆë‹¤.</p><p>ì†ë„ê°€ ì¤‘ìš”í•œ <code>ë‚´íì°¾ê¸°</code>ì—ëŠ” <code>Modal</code> ì„ ì´ìš©í•˜ì˜€ìœ¼ë©°, API ìƒí˜¸ì‘ìš© ë° ìƒˆë¡œê³ ì¹¨ì´ í•„ìš”í•œ <code>ì»¤ë®¤ë‹ˆí‹°</code>ì—ì„œëŠ” <code>ìƒˆë¡œìš´ í˜ì´ì§€</code>ë¡œ ì´ë™í•˜ê³  ë’¤ë¡œê°€ê¸° ì‹œì— LocalStorageë¥¼ ì°¸ì¡°í•˜ì—¬ ì €ì¥ëœ ScrollYê°’ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™ë˜ê²Œ í•˜ì˜€ìŠµë‹ˆë‹¤.</p><p><strong>ë‚´íì°¾ê¸°</strong> <a href=http://kimchibilliards.synology.me:3001/findcue target=_blank>(ì ìš©ëœ í˜ì´ì§€)</a></p><ul><li>í˜ì´ì§€ ì´ë™ì—†ì´ <code>Modal</code>ì´ ë³´ì—¬ì§€ëŠ” í˜•ì‹ìœ¼ë¡œ ì œê³µí•œë‹¤.</li><li><code>Modal</code>ì´ ì—´ë¦´ë•Œ ë”°ë¡œ APIì—ì„œ ì •ë³´ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šê³  ì¦‰ì‹œ ë³´ì—¬ì§ˆ ìˆ˜ ìˆë„ë¡ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¬ ë•Œ APIë¥¼ ëª¨ë‹¬ì•ˆì˜ ì •ë³´ê¹Œì§€ ì œê³µí•  ìˆ˜ ìˆë„ë¡ ì œì‘í•œë‹¤.</li><li>í•œë²ˆ ë¶ˆëŸ¬ì˜¨ ì´ë¯¸ì§€ë‚˜ <code>ìºì‹œ</code>ì— ë‚¨ê²¨ ë¡œë”©í•  ë•Œë„ ë§¤ìš°ë¹ ë¥¸ ë¡œë”©ì†ë„ë¥¼ ì œê³µí•œë‹¤.</li><li>ìŠ¤í¬ë¡¤ ì‹œ ë§ˆì§€ë§‰ ì•„ì´í…œì´ ë³´ì—¬ì§ˆ ë•Œ ë§ˆë‹¤ Fade in ì• ë‹ˆë©”ì´ì…˜ì„ ì ìš©í•˜ì—¬ ë¡œë”©ì´ ì¦‰ê°ì ìœ¼ë¡œ ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì—¬ì§€ê²Œ í•œë‹¤.</li></ul><figure class=align-center><img loading=lazy src=../img/2.gif#center alt="Infinite Scroll + Modal + aos fadein"><figcaption><p><code>Infinite Scroll</code> + <code>Modal</code> + <code>aos fadein</code></p></figcaption></figure><p><strong>ì»¤ë®¤ë‹ˆí‹°</strong> <a href=http://kimchibilliards.synology.me:3001/community target=_blank>(ì ìš©ëœ í˜ì´ì§€)</a></p><ul><li><code>List</code>ì—ì„œ <code>Item</code> í´ë¦­ ì‹œ <code>ìƒˆë¡œìš´ ìƒì„¸í˜ì´ì§€</code>ë¡œ ì´ë™</li><li>ì´ë™í• ë•Œ ì´ë•Œ <code>LocalStoarge</code>ì— <code>scrollY</code> ê°’ì„ ì €ì¥</li><li>ìƒì„¸í˜ì´ì§€ì—ì„œ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ì˜¬ ë•Œ <code>scrollY ê°’ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì´ë™</code></li><li>ë‹¨, ì´ë•Œ ì²˜ìŒë¶€í„° Listë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´ ì €ì¥ëœ scrollY ê°’ìœ¼ë¡œ ê°€ì§ˆ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ (1ë²ˆ ì´ìƒ ì¶”ê°€ë¡œë”©ì´ ë˜ì—ˆì„ ê²½ìš°) <code>ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ëŠ” ìƒˆë¡œ ë¶ˆëŸ¬ì˜¤ë©´ ì•ˆëœë‹¤</code>.</li></ul><figure class=align-center><img loading=lazy src=../img/3.gif#center alt="Infinite Scroll + Link + LocalStorage"><figcaption><p><code>Infinite Scroll</code> + <code>Link</code> + <code>LocalStorage</code></p></figcaption></figure><br><h3 id=api-ì¤€ë¹„>API ì¤€ë¹„<a hidden class=anchor aria-hidden=true href=#api-ì¤€ë¹„>#</a></h3><p>APIëŠ” Djangoë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ModelViewSetì„ ì‚¬ìš©í•˜ì˜€ìœ¼ë©° <code>LimitOffsetPagination</code>ì„ ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.</p><p>ì¼ë°˜ì ì¸ í˜ì´ì§€ í˜ì§€ë„¤ì´ì…˜ì˜ ê²½ìš° ì‚¬ìš©ìê°€ ë‹¤ìŒ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸° ì „ì— ìƒˆë¡œìš´ ì•„ì´í…œì´ 1ê°œê°€ ë“±ë¡ë˜ê³  ë¦¬ìŠ¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´ ì¤‘ë³µë˜ëŠ” ì•„ì´í…œì´ í‘œì‹œë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ offset paginationì„ ì ìš©í•˜ì—¬ ì „ì²´ ê²Œì‹œê¸€ì´ ëŠ˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ëŠ˜ì€ ë§Œí¼ offsetì„ ì¶”ê°€ë¡œ ë”í•´ì£¼ì–´ì•¼ ì¤‘ë³µë˜ëŠ” ì•„ì´í…œì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ë¦¬ìŠ¤íŠ¸ì—ì„œ ë¡œë”©ë  <code>í•„í„°ë§ ì¡°ê±´</code>ì„ <code>parameter</code> ë¡œ ë°›ê¸° ìœ„í•´ querysetì„ ë³€ê²½í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ì˜€ìŠµë‹ˆë‹¤. <code>offset</code>ë˜í•œ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ì˜µë‹ˆë‹¤.</p><h4 id=viewspy><code>views.py</code><a hidden class=anchor aria-hidden=true href=#viewspy>#</a></h4><div class="terminal space shadow"><div class=top><div class=btns><span class="circle red"></span>
<span class="circle yellow"></span>
<span class="circle green"></span></div><div class=title>views.py</div></div><div class=terminalbody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>someview</span><span class=p>(</span><span class=n>viewsets</span><span class=o>.</span><span class=n>ModelViewSet</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>queryset</span> <span class=o>=</span> <span class=n>somemodel</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>exclude</span><span class=p>(</span><span class=n>Q</span><span class=p>(</span><span class=n>something</span><span class=p>))</span><span class=o>.</span><span class=n>prefetch_related</span><span class=p>(</span><span class=n>Prefetch</span><span class=p>(</span><span class=n>something</span><span class=p>))</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>permission_classes</span> <span class=o>=</span> <span class=n>somepermission</span>
</span></span><span class=line><span class=cl>    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>someSerializer</span>
</span></span><span class=line><span class=cl>    <span class=n>pagination_class</span> <span class=o>=</span> <span class=n>LimitOffsetPagination</span>
</span></span><span class=line><span class=cl>    <span class=n>filter_backends</span> <span class=o>=</span> <span class=p>(</span><span class=n>somefilters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ordering_fields</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;created_at&#39;</span><span class=p>,</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ordering</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;-created_at&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>search_fields</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;$title&#39;</span><span class=p>,</span> <span class=s1>&#39;$content&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>filterset_fields</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;__all__&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_queryset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>qs</span> <span class=o>=</span> <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=n>get_queryset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=c1># some condition</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>qs</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>Query</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></div></div><br><p>ë¦¬í„´ ì˜ˆì‹œ</p><div class="terminal space shadow"><div class=top><div class=btns><span class="circle red"></span>
<span class="circle yellow"></span>
<span class="circle green"></span></div><div class=title>GET</div></div><div class=terminalbody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Json data-lang=Json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;count&#34;</span><span class=p>:</span> <span class=mi>131</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;next&#34;</span><span class=p>:</span> <span class=s2>&#34;apiì£¼ì†Œ/?limit=20&amp;offset=55&amp;í•„í„°ë§ì¡°ê±´&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;previous&#34;</span><span class=p>:</span> <span class=s2>&#34;apiì£¼ì†Œ/?limit=20&amp;offset=15&amp;í•„í„°ë§ì¡°ê±´&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;results&#34;</span><span class=p>:[</span>
</span></span><span class=line><span class=cl>        <span class=err>...</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div></div><br><h3 id=infinitescroll-ì„¤ì¹˜-ë°-ì¤€ë¹„><code>infiniteScroll</code> ì„¤ì¹˜ ë° ì¤€ë¹„<a hidden class=anchor aria-hidden=true href=#infinitescroll-ì„¤ì¹˜-ë°-ì¤€ë¹„>#</a></h3><p>react-qeuryë¥¼ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤. ì‚¬ìš©ëœ ë²„ì „ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><div class="terminal space shadow"><div class=top><div class=btns><span class="circle red"></span>
<span class="circle yellow"></span>
<span class="circle green"></span></div><div class=title>package.json</div></div><div class=terminalbody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Json data-lang=Json><span class=line><span class=cl><span class=err>...</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;react-query&#34;</span><span class=err>:</span> <span class=s2>&#34;^3.39.2&#34;</span><span class=err>,</span>
</span></span><span class=line><span class=cl><span class=err>...</span>
</span></span></code></pre></td></tr></table></div></div></div></div><br><p>Hydrationì„ í†µí•´ SSR(Server Side Rendering)ì„ í•  ìˆ˜ ë„ ìˆì§€ë§Œ, ì‹œë„í•´ë³¸ ê²°ê³¼ ë§¤ ë’¤ë¡œê°€ê¸°ì‹œ <code>ìºì‹±ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ</code>ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ì •í™•íˆ ë§í•˜ë©´ ì´ë¯¸ ë¡œë”©í–ˆë˜ ë‚´ìš©ë“¤ì„ ë‹¤ì‹œ ì²˜ìŒë¶€í„° ë¡œë”©í•´ì•¼ í–ˆìŠµë‹ˆë‹¤. ë‚´íì°¾ê¸° ì²˜ëŸ¼ ëª¨ë‹¬ì„ ì‚¬ìš©í•  ê²½ìš° Hydration ì‚¬ìš©í•´ë„ ì§€ì¥ì—†ì§€ë§Œ, í˜ì´ì§€ ì´ë™ì´ í•„ìš”í•œ ê²½ìš° í•´ë‹¹ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.</p><h4 id=_apptsx-hydration><code>_app.tsx (Hydration)</code><a hidden class=anchor aria-hidden=true href=#_apptsx-hydration>#</a></h4><div class="terminal space shadow"><div class=top><div class=btns><span class="circle red"></span>
<span class="circle yellow"></span>
<span class="circle green"></span></div><div class=title>_app.tsx (Hydration)</div></div><div class=terminalbody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=cm>/* eslint-disable @typescript-eslint/no-explicit-any */</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>AOS</span> <span class=kr>from</span> <span class=s2>&#34;aos&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Head</span> <span class=kr>from</span> <span class=s2>&#34;next/head&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>SessionProvider</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;next-auth/react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>QueryClient</span><span class=p>,</span> <span class=nx>QueryClientProvider</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;react-query&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;@/styles/aos.scss&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;@/styles/globals.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;@/styles/colors.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MyApp</span>: <span class=kt>NextComponentType</span><span class=p>&lt;</span><span class=nt>AppContext</span><span class=err>,</span> <span class=na>AppInitialProps</span><span class=err>,</span> <span class=na>AppProps</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>Component</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>pageProps</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>queryClientRef</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>useRef</span><span class=p>&lt;</span><span class=nt>QueryClient</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>queryClientRef</span><span class=p>.</span><span class=nx>current</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>queryClientRef</span><span class=p>.</span><span class=nx>current</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>QueryClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>AOS</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>once</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>duration</span>: <span class=kt>500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>easing</span><span class=o>:</span> <span class=s2>&#34;ease-out-cubic&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>QueryClientProvider</span> <span class=na>client</span><span class=o>=</span><span class=p>{</span><span class=nx>queryClientRef</span><span class=p>.</span><span class=nx>current</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>Hydrate</span> <span class=na>state</span><span class=o>=</span><span class=p>{</span><span class=nx>pageProps</span><span class=p>.</span><span class=nx>dehydratedState</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>Component</span> <span class=p>{</span><span class=na>...pageProps</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>Hydrate</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* &lt;ReactQueryDevtools /&gt; */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>QueryClientProvider</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nx>MyApp</span><span class=p>.</span><span class=nx>getInitialProps</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>Component</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>ctx</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=o>:</span> <span class=nx>AppContext</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>AppInitialProps</span><span class=p>&gt;</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>pageProps</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>Component</span><span class=p>.</span><span class=nx>getInitialProps</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>pageProps</span> <span class=o>=</span> <span class=k>await</span> <span class=nx>Component</span><span class=p>.</span><span class=nx>getInitialProps</span><span class=p>(</span><span class=nx>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span> <span class=nx>pageProps</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>MyApp</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div></div></div><br><p>ë”°ë¼ì„œ ìµœì¢…ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì ìš©í–ˆìŠµë‹ˆë‹¤. ì¤‘ê°„ì— <code>meta</code> íƒœê·¸ëŠ” ì•„ì´í°ì—ì„œ ëª¨ë‹¬ì´ ì—´ë¦´ë•Œ ê°€ë¡œí­ì´ ê³ ì •ë˜ì§€ ì•ŠëŠ” ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë„£ì—ˆìœ¼ë©° ë”°ë¡œ meta tagë¥¼ ê´€ë¦¬í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ìˆìœ¼ë©´ ì¶”ê°€í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ëŒ“ê¸€ ì‘ì„±ì´ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ë•Œë¬¸ì— <code>SessionProvider (next-auth)</code>ê°€ ìˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ êµ¬í˜„ì´ í•„ìš” ì—†ë‹¤ë©´ ë„˜ê¸°ì…”ë„ ë©ë‹ˆë‹¤.</p><h4 id=_apptsx><code>_app.tsx</code><a hidden class=anchor aria-hidden=true href=#_apptsx>#</a></h4><div class="terminal space shadow"><div class=top><div class=btns><span class="circle red"></span>
<span class="circle yellow"></span>
<span class="circle green"></span></div><div class=title>_app.tsx</div></div><div class=terminalbody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=cm>/* eslint-disable @typescript-eslint/no-explicit-any */</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>AOS</span> <span class=kr>from</span> <span class=s2>&#34;aos&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Head</span> <span class=kr>from</span> <span class=s2>&#34;next/head&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>SessionProvider</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;next-auth/react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;react&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>QueryClient</span><span class=p>,</span> <span class=nx>QueryClientProvider</span> <span class=p>}</span> <span class=kr>from</span> <span class=s2>&#34;react-query&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;@/styles/aos.scss&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;@/styles/globals.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=s2>&#34;@/styles/colors.css&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MyApp</span> <span class=o>=</span> <span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>Component</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>pageProps</span><span class=o>:</span> <span class=p>{</span> <span class=nx>session</span><span class=p>,</span> <span class=p>...</span><span class=nx>pageProps</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>Component</span>: <span class=kt>any</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>pageProps</span>: <span class=kt>any</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>})</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>queryClient</span><span class=p>]</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>useState</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>QueryClient</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// AOS ì• ë‹ˆë©”ì´ì…˜ ì ìš©
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>useEffect</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>AOS</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>once</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>duration</span>: <span class=kt>500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>easing</span><span class=o>:</span> <span class=s2>&#34;ease-out-cubic&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=c1>// next-auth ë¡œê·¸ì¸ ì„¸ì…˜ì„ ìœ„í•´ ì‚¬ìš©ë¨
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>&lt;</span><span class=nt>SessionProvider</span> <span class=na>session</span><span class=o>=</span><span class=p>{</span><span class=nx>session</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* ì•„ì´í° ê°€ë¡œê°’ ê³ ì •ë˜ì§€ ì•ŠëŠ” ì´ìŠˆ í•´ê²° */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>meta</span>
</span></span><span class=line><span class=cl>          <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>Head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* infiniteScroll ìœ„í•´ ì„ ì–¸ */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>QueryClientProvider</span> <span class=na>client</span><span class=o>=</span><span class=p>{</span><span class=nx>queryClient</span><span class=p>}&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* PageProps í‘œì‹œ ì˜ì—­ */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>Component</span> <span class=p>{</span><span class=na>...pageProps</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* Debug ëª¨ë“œì—ì„œë§Œ í™œìš©í•  devtools */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* import { ReactQueryDevtools } from &#39;react-query/devtools&#39;;
</span></span></span><span class=line><span class=cl><span class=cm>        &lt;ReactQueryDevtools initialIsOpen={false} /&gt; */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>QueryClientProvider</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>SessionProvider</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>MyApp</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div></div></div><br><p>ë¬´í•œ ë¡œë”© ë¦¬ìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•˜ëŠ” í° ë¼ˆëŒ€ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. ë‹¹ì—°íˆ ì½”ë“œê°€ ëŒì•„ê°€ì§€ ì•Šìœ¼ë¯€ë¡œ ì°¸ê³ ë§Œ í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</p><h4 id=infinitelistskeletontsx><code>InfiniteListSkeleton.tsx</code><a hidden class=anchor aria-hidden=true href=#infinitelistskeletontsx>#</a></h4><div class="terminal space shadow"><div class=top><div class=btns><span class="circle red"></span>
<span class="circle yellow"></span>
<span class="circle green"></span></div><div class=title>InfiniteListSkeleton.tsx</div></div><div class=terminalbody><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Typescript data-lang=Typescript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>InfiniteListSkeleton</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;í•„í„°ë§ ë  ë‚´ìš©ë“¤&#39;</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>hasNextPage</span><span class=p>,</span> <span class=nx>fetchNextPage</span><span class=p>,</span> <span class=nx>refetch</span><span class=p>,</span> <span class=nx>isFetching</span> <span class=p>}</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>    <span class=nx>useInfiniteQuery</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;some&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>({</span> <span class=nx>pageParam</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span> <span class=p>})</span> <span class=o>=&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// FetchList í•¨ìˆ˜ëŠ” axiosë¡œ apiì— request ë³´ë‚´ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. (íŒŒë¼ë¯¸í„°ë¡œ í•„í„°ë§ ë  ë‚´ìš©ì„ ë°›ìŠµë‹ˆë‹¤.)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>FetchList</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=nx>pageParam</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s1>&#39;í•„í„°ë§ ë  ë‚´ìš©ë“¤&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ë‹¤ìŒ í˜ì´ì§€ëŠ” offset ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>getNextPageParam</span><span class=o>:</span> <span class=p>(</span><span class=nx>lastPage</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=nx>lastPage</span><span class=p>.</span><span class=nx>next</span> <span class=o>===</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>undefined</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>lastPage</span><span class=p>.</span><span class=nx>next</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>lastOffset</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>searchParams</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=s1>&#39;offset&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=nx>lastOffset</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>lastOffset</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>undefined</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>staleTime</span>: <span class=kt>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>cacheTime</span>: <span class=kt>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>keepPreviousData</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>refetchOnMount</span>: <span class=kt>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>refetchOnWindowFocus</span>: <span class=kt>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 1. ëª¨ë‹¬ë¡œ ì˜¤í”ˆí•  ê±°ë©´ (ì»¤ìŠ¤í…€ í›…)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>dialog</span> <span class=o>=</span> <span class=nx>useDialog</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>openModal</span> <span class=o>=</span> <span class=p>(</span><span class=nx>props</span>: <span class=kt>Results</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>dialog</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>title</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>description</span><span class=o>:</span> <span class=p>&lt;&gt;&lt;/&gt;,</span>
</span></span><span class=line><span class=cl>      <span class=nx>catchOnCancel</span>: <span class=kt>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>submitText</span><span class=o>:</span> <span class=s1>&#39;ë„¤&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>cancleText</span><span class=o>:</span> <span class=s1>&#39;ë‹«ê¸°&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>variant</span><span class=o>:</span> <span class=s1>&#39;warning&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>props</span>: <span class=kt>props</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=k>catch</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>&lt;&gt;&lt;/&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 2. í˜ì´ì§€ ì´ë™í›„ ìŠ¤í¬ë¡¤ Y ê°’ì„ ì €ì¥í•˜ì—¬ í•´ë‹¹ ìœ„ì¹˜ë¡œ ë°”ë¡œ ë³´ì—¬ì§€ê²Œ í•  ê²½ìš°
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>[</span><span class=nx>scrollY</span><span class=p>,</span> <span class=nx>setScrollY</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useLocalStorage</span><span class=p>(</span><span class=s1>&#39;someScroll&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>React</span><span class=p>.</span><span class=nx>useEffect</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>scrollY</span> <span class=o>!==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>window</span><span class=p>.</span><span class=nx>scrollTo</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>scrollY</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=nx>setScrollY</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// eslint-disable-next-line react-hooks/exhaustive-deps
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// í•„í„°ê°€ ì ìš©ë˜ë©´ offsetì„ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒë¶€í„° ë¡œë”©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>React</span><span class=p>.</span><span class=nx>useEffect</span><span class=p>(()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>isRefreshing</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>refetch</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>setIsRefreshing</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>[</span><span class=nx>isRefreshing</span><span class=p>,</span> <span class=nx>refetch</span><span class=p>,</span> <span class=nx>setIsRefreshing</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// useRefë¥¼ ì´ìš©í•˜ì—¬ í•´ë‹¹ Refë¥¼ í•˜ë‹¨ì— ë‘ê³  ë³´ì—¬ì§€ë©´ ë‹¤ìŒ í˜ì´ì§€ë¥¼ ë¡œë”©í•©ë‹ˆë‹¤.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>loadMoreButtonRef</span> <span class=o>=</span> <span class=nx>React</span><span class=p>.</span><span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>useIntersectionObserver</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>root</span>: <span class=kt>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span>: <span class=kt>loadMoreButtonRef</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>onIntersect</span>: <span class=kt>fetchNextPage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>enabled</span>: <span class=kt>hasNextPage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* ë¡œë”©ì¤‘ì¼ë•Œ */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>isFetching</span> <span class=o>&amp;&amp;</span> <span class=p>&lt;</span><span class=nt>LoadingDiv</span> <span class=p>/&gt;}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=cm>/* ë¦¬ìŠ¤íŠ¸ë¥¼ í‘œì‹œí•©ã„´ë””ã…. */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=nx>data</span><span class=o>?</span><span class=p>.</span><span class=nx>pages</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>page</span><span class=p>)</span> <span class=o>=&gt;</span>
</span></span><span class=line><span class=cl>          <span class=nx>page</span><span class=p>.</span><span class=nx>results</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>props</span>: <span class=kt>Results</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=c1>// data-aos ë¡œ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ì¤ë‹ˆë‹¤. (ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í•„ìš”))
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>&lt;</span><span class=nt>li</span> <span class=na>key</span><span class=o>=</span><span class=p>{</span><span class=nx>props</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span> <span class=na>data</span><span class=err>-</span><span class=na>aos</span><span class=o>=</span><span class=s>&#39;fade-up&#39;</span> <span class=na>data</span><span class=err>-</span><span class=na>aos</span><span class=err>-</span><span class=na>duration</span><span class=o>=</span><span class=s>&#39;200&#39;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>              <span class=p>{</span><span class=cm>/* 1. ëª¨ë‹¬ë¡œ ì˜¤í”ˆí• êº¼ë©´ */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>&lt;</span><span class=nt>div</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=o>=&gt;</span> <span class=nx>openModal</span><span class=p>(</span><span class=nx>props</span><span class=p>)}&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nx>Click</span> <span class=nx>$</span><span class=p>{</span><span class=nx>props</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span> <span class=nx>to</span> <span class=nx>open</span> <span class=nx>Modal</span>
</span></span><span class=line><span class=cl>              <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>              <span class=p>{</span><span class=cm>/* 2. í˜ì´ì§€ ì´ë™í• ê±°ë©´ */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=p>&lt;</span><span class=nt>Link</span>
</span></span><span class=line><span class=cl>                <span class=na>href</span><span class=o>=</span><span class=p>{{</span>
</span></span><span class=line><span class=cl>                  <span class=nx>pathname</span><span class=o>:</span> <span class=sb>`url/</span><span class=si>${</span><span class=nx>props</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nx>query</span><span class=o>:</span> <span class=p>{</span> <span class=nx>props</span>: <span class=kt>JSON.stringify</span><span class=p>(</span><span class=nx>props</span><span class=p>)</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>}}</span>
</span></span><span class=line><span class=cl>                <span class=na>as</span><span class=o>=</span><span class=p>{</span><span class=sb>`url/</span><span class=si>${</span><span class=nx>props</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=na>passHref</span>
</span></span><span class=line><span class=cl>              <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>a</span>
</span></span><span class=line><span class=cl>                  <span class=na>href</span><span class=o>=</span><span class=p>{</span><span class=sb>`url/</span><span class=si>${</span><span class=nx>props</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                  <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=o>=&gt;</span> <span class=nx>setScrollY</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>scrollY</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>                <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=nx>Click</span> <span class=nx>$</span><span class=p>{</span><span class=nx>props</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span> <span class=nx>to</span> <span class=nx>navigate</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>              <span class=p>&lt;/</span><span class=nt>Link</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>)))}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=cm>/* ë¡œë”©ì¤‘ í‘œì‹œë¥¼ í•˜ê³  refê°€ focus ë ë•Œ (ë¦¬ìŠ¤íŠ¸ì˜ ëì¼ë•Œ) ë§ˆë‹¤ ë‹¤ìŒ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¡œë”©í•©ë‹ˆë‹¤. */</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span><span class=nx>hasNextPage</span> <span class=o>&amp;&amp;</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>LoadingDiv</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>          <span class=p>&lt;</span><span class=nt>button</span> <span class=na>onClick</span><span class=o>=</span><span class=p>{()</span> <span class=o>=&gt;</span> <span class=nx>fetchNextPage</span><span class=p>()}</span> <span class=na>className</span><span class=o>=</span><span class=s>&#39;text-center&#39;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>)}</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>div</span> <span class=na>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>loadMoreButtonRef</span><span class=p>}</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>InfiniteListSkeleton</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div></div></div><br><h3 id=infinitescroll--modal-ë‚´íì°¾ê¸°><code>infiniteScroll</code> + <code>Modal</code> [ë‚´íì°¾ê¸°]<a hidden class=anchor aria-hidden=true href=#infinitescroll--modal-ë‚´íì°¾ê¸°>#</a></h3><p>ê³„ì† &mldr;</p><h3 id=infinitescroll--localstorage--scrolly-ì»¤ë®¤ë‹ˆí‹°><code>infiniteScroll</code> + <code>LocalStorage</code> + <code>ScrollY</code> [ì»¤ë®¤ë‹ˆí‹°]<a hidden class=anchor aria-hidden=true href=#infinitescroll--localstorage--scrolly-ì»¤ë®¤ë‹ˆí‹°>#</a></h3><p>ê³„ì† &mldr;</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://cha2hyun.github.io/tags/next.js/>Next.js</a></li><li><a href=https://cha2hyun.github.io/tags/react-query/>React Query</a></li><li><a href=https://cha2hyun.github.io/tags/infinite-scroll/>Infinite Scroll</a></li></ul><div style=padding-top:15px;padding-bottom:2px;font-size:x-large;font-weight:700>Any Comments? ğŸ˜€</div><div class=share-buttons></div><script src=https://utteranc.es/client.js repo=cha2hyun/blog-comments issue-term=title theme=boxy-light crossorigin=anonymous async></script></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://cha2hyun.github.io/>ì±„ìˆ˜í˜„ ê°œë°œì¼ì§€</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>